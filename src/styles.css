:root {
  --bg: #0b1220;
  --panel: #0f172a;
  --card: #0b1324;
  --border: #334155;
  --muted: #94a3b8;
  --good: #10b981;
  --warn: #f59e0b;
  --bad: #ef4444;
  --accent: #22c55e;
}
* { box-sizing: border-box; }
body { margin:0; background:var(--bg); color:#e5e7eb; font-family:system-ui, Segoe UI, Roboto, Inter, Arial; }

.container { max-width:1100px; margin:0 auto; padding:20px; }
.header { display:flex; align-items:center; justify-content:space-between; padding:10px 0; }
.brand { font-weight:800; font-size:20px; }

.topnav { position:sticky; top:0; z-index:5; background:rgba(11,18,32,.7); backdrop-filter: blur(6px); padding:10px 16px; border-bottom:1px solid #1f2937; display:flex; gap:10px; align-items:center; }
.topnav .link { background:transparent; color:#e5e7eb; border:1px solid #1f2937; border-radius:8px; padding:6px 10px; cursor:pointer; }
.topnav .link.active { border-color: var(--accent); }
.topnav .sp { color:#334155; }

.row { display:flex; gap:16px; flex-wrap:wrap; }
.card { background: linear-gradient(180deg, #0f172a 0%, #0b1020 100%); border:1px solid #1f2937; border-radius:14px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.25); }
.bigbtn { font-size: clamp(22px, 4vw, 36px); padding: 26px 28px; border-radius: 18px; border:2px solid #374151; background:#0f172a; color:#eef2ff; cursor:pointer; flex:1; min-width:280px; transition: transform .08s ease, border-color .2s; }
.bigbtn:hover { transform:translateY(-2px); border-color:var(--accent); }

.toolbar { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.button { background:#111827; border:1px solid #374151; color:#e5e7eb; padding:10px 14px; border-radius:10px; cursor:pointer; }
.button.primary { background:#16a34a; border-color:#16a34a; color:white; }
.button.ghost { background:transparent; border-color:#374151; }
.badge { font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid #334155; color:#a7f3d0; }

.panes { display:grid; grid-template-columns: 1.15fr .85fr; gap:16px; }
.right-steps { position:relative; }

.step-panel { position:sticky; top:62px; }
.step-title { font-weight:700; margin-bottom:8px; }
.muted { color:var(--muted); font-size:13px; }

.chips { display:flex; gap:8px; flex-wrap:wrap; margin:10px 0; }
.chip { display:inline-flex; align-items:center; justify-content:center; padding:8px 12px; border-radius:999px; border:1px solid var(--border); background:#0b1324; cursor:grab; user-select:none; }

.slot { display:inline-flex; min-width:64px; min-height:40px; border:2px dashed var(--border); border-radius:10px; align-items:center; justify-content:center; padding:4px 8px; }
.slot.glow { border-color: var(--accent); }
.fraction-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.fraction { display:flex; flex-direction:column; align-items:center; gap:6px; font-size:22px; }
.frac-bar { width:120px; height:2px; background:#64748b; }

.shape-area { min-height:380px; }
.rects { display:flex; gap:20px; }
.rect { position:relative; width:300px; height:190px; border-radius:10px; background:#1d4ed8; border:4px solid #60a5fa; }
.rect.copy { background:#7c3aed; border-color:#a78bfa; }
.shape-label { position:absolute; top:-14px; left:10px; background:#0b1324; padding:4px 8px; border-radius:6px; border:1px solid var(--border); font-size:12px; opacity:.9; }
.shape-label.hidden { opacity:0.35; filter:grayscale(1); }

.side-tag { position:absolute; padding:4px 8px; border-radius:8px; background:#0b1324; border:1px solid var(--border); color:#fff; font-weight:700; font-size:18px; }
.side-tag.top    { top:-18px; left:50%; transform:translateX(-50%); }
.side-tag.bottom { bottom:-22px; left:50%; transform:translateX(-50%); }
.side-tag.left   { left:-28px; top:50%; transform:translateY(-50%); }
.side-tag.right  { right:-28px; top:50%; transform:translateY(-50%); }

.side-hit { position:absolute; }
.side-hit.top    { top:-6px; left:8px; right:8px; height:12px; }
.side-hit.bottom { bottom:-6px; left:8px; right:8px; height:12px; }
.side-hit.left   { left:-6px; top:8px; bottom:8px; width:12px; }
.side-hit.right  { right:-6px; top:8px; bottom:8px; width:12px; }
.side-hit.good { outline:3px solid var(--good); border-radius:6px; }

.summary-panel { position:fixed; inset:0; background:rgba(2,6,23,.75); display:flex; align-items:center; justify-content:center; }
.summary-card { width:min(1100px, 94vw); max-height:88vh; overflow:auto; }

.kv { display:grid; grid-template-columns: repeat(12, 1fr); gap:8px; }
.kv .col { background:#0b1324; border:1px solid var(--border); padding:6px; border-radius:8px; text-align:center; }
.kv .head { transform: skew(-18deg); background:#111827; font-size:12px; color:#cbd5e1; }
.stepbox { padding:8px; border-radius:8px; border:1px solid var(--border); text-align:center; }
.stepbox.ok   { background:#052e1a; border-color:#14532d; }
.stepbox.warn { background:#3a2f05; border-color:#92400e; }
.stepbox.bad  { background:#3f0a0a; border-color:#7f1d1d; }

.htable { border-collapse:collapse; width:100%; }
.htable th, .htable td { border:1px solid var(--border); padding:10px; text-align:center; }
.houtline { border:2px solid #475569; border-radius:8px; width:100%; height:160px; display:grid; grid-template-columns:1fr 1fr; grid-template-rows:1fr 1fr; gap:0; }

.problem { font-size:18px; line-height:1.5; }
.altmeta { margin-top:6px; color:#a8b1c5; font-size:12px; }

.red-oval { outline: 3px solid #ef4444; border-radius: 999px; padding:2px 6px; }
.triple-ul { text-decoration: underline; text-decoration-thickness: 3px; text-underline-offset: 4px; font-weight:900; }
